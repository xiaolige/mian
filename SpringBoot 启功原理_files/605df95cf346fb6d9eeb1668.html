<!DOCTYPE html>
<!-- saved from url=(0076)https://www.processon.com/outline/view/link/605df95cf346fb6d9eeb1668?pw=null -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">


<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
<title>SpringBoot-思维笔记|ProcessOn</title>
<meta name="title" content="Outline">
<meta name="keyword" content="Outline">
<meta name="description" content="Outline">
<link type="text/css" rel="stylesheet" href="./outline.css">
<link type="text/css" rel="stylesheet" href="./icons(1).css">
<style>
body{padding-top: 0!important;}
#outline-con, #outline-con-search{padding-top: 20px;}
</style>
<script async="" src="./analytics.js.下载"></script><script type="text/javascript" id="zhuge-js" async="" src="./zhuge.min.js, attachment"></script><script>
var chartId = "5fe4a07e7d9c087ce9965182", chartTitle = "SpringBoot", userId = "", userName = "", fullName = "", tempId = "606263096376890cb613fa26";
</script>
</head>
<body theme="light" page="a4" class="readonly">
<div class="outline-body">
<div id="outline" class="outline-main">
<div id="outline-con"><div id="root" class="designer-outline-title"><div spellcheck="false" autocapitalize="false" class="node-title" placeholder="未命名文件">SpringBoot启动流程<br>SpringApplication.run</div></div><div id="f747ab521b8e" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div><div class="node-state"><span class="openIcon ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title ">1.初始化SpringApplication:<br><b><font color="#31a8e0">new SpringApplication(primarySources)</font></b><br></div></div><div class="node-children line"><div id="5de8f1f73c5e" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title ">将启动类放入primarySources</div></div><div class="node-remark" contenteditable="true" spellcheck="false" autocapitalize="false">` this.primarySources = new LinkedHashSet&lt;&gt;(Arrays.asList(primarySources));`</div><div class="node-children line"></div></div><div id="d01cec13e2ee" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title ">推算当前web应用类型&nbsp;webApplicationType </div></div><div class="node-remark" contenteditable="true" spellcheck="false" autocapitalize="false">`` this.webApplicationType = WebApplicationType.deduceFromClasspath();``</div><div class="node-children line"></div></div><div id="fe50658d5ef5" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title ">读取ApplicationContextInitializer 初始化器</div></div><div class="node-remark" contenteditable="true" spellcheck="false" autocapitalize="false">去spring.factories 中去获取所有key:org.springframework.context.ApplicationContextInitializer
`   setInitializers((Collection) getSpringFactoriesInstances(ApplicationContextInitializer.class));`</div><div class="node-children line"></div></div><div id="ef0b1ebb2630" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title ">读取ApplicationListener 监听器</div></div><div class="node-remark" contenteditable="true" spellcheck="false" autocapitalize="false">去spring.factories 中去获取所有key: org.springframework.context.ApplicationListener
   `setListeners((Collection) getSpringFactoriesInstances(ApplicationListener.class));`</div><div class="node-children line"></div></div><div id="5da96207a4c4" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title ">将main方法所在的类放入mainApplicationClass </div></div><div class="node-remark" contenteditable="true" spellcheck="false" autocapitalize="false">   // 根据main方法推算出`mainApplicationClass 
   this.mainApplicationClass = deduceMainApplicationClass();`</div><div class="node-children line"></div></div></div></div><div id="1931b727f214" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div><div class="node-state"><span class="openIcon ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title ">2.启动SpringBoot:<br><b><font color="#31a8e0">.run(args);</font></b><br></div></div><div class="node-children line"><div id="1e3367523bbc" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title " style="color: rgb(255, 255, 255);">记录启动开始时间</div></div><div class="node-remark" contenteditable="true" spellcheck="false" autocapitalize="false">`stopWatch.start();`</div><div class="node-children line"></div></div><div id="07db04d4b43a" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title " style="border-radius: 0px; color: rgb(102, 102, 102); border-color: rgb(136, 136, 136);">开启handless</div></div><div class="node-remark" contenteditable="true" spellcheck="false" autocapitalize="false">##### configureHeadlessProperty();：
`
设置java.awt.headless=true
`</div><div class="node-children line"></div></div><div id="7eeffa7d4818" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title ">读取SpringApplicationRunListeners 监听器运行器</div></div><div class="node-remark" contenteditable="true" spellcheck="false" autocapitalize="false">`SpringApplicationRunListeners listeners = getRunListeners(args);`</div><div class="node-children line"></div></div><div id="191ffe73555c" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><span class="node-icons" style="width: 25.1px;"><span n="priority" ico="0" class="mind-icons"></span></span><div spellcheck="false" autocapitalize="false" class="node-title " style="border-radius: 6px;">发布1.ApplicationStartingEvent事件</div></div><div class="node-remark" contenteditable="true" spellcheck="false" autocapitalize="false">ApplicationStartingEvent在运行开始时发送，但在进行任何处理之前
```
listeners.starting();
```</div><div class="node-children line"></div></div><div id="f2de8eee7824" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title ">封装命令行参数ApplicationArguments </div></div><div class="node-remark" contenteditable="true" spellcheck="false" autocapitalize="false">```java
ApplicationArguments applicationArguments = new DefaultApplicationArguments(args);
			
```</div><div class="node-children line"></div></div><div id="4ad92ed70c55" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div><div class="node-state"><span class="openIcon ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title ">读取环境配置信息</div></div><div class="node-remark" contenteditable="true" spellcheck="false" autocapitalize="false">#####读取环境变量，读取配置文件信息（基于监听器）
```
ConfigurableEnvironment environment = prepareEnvironment(listeners, applicationArguments);
```</div><div class="node-children line"><div id="190e9181dd44" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title ">根据webApplicationType创建环境变量对象</div></div><div class="node-remark" contenteditable="true" spellcheck="false" autocapitalize="false">此时已经读取到了： java环境变量和系统环境变量</div><div class="node-children line"></div></div><div id="9c95394df2b4" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title ">配置环境变量</div></div><div class="node-remark" contenteditable="true" spellcheck="false" autocapitalize="false">**1.读取SpringApplication.defaultProperties 和命令行参数**
`configurePropertySources(environment, args);`

**2.根据环境变量中spring.profiles.active 和
SpringApplication.additionalProfiles 激活当前profile**
`configureProfiles(environment, args);`

```java
protected void configureProfiles(ConfigurableEnvironment environment, String[] args) {
		Set<string> profiles = new LinkedHashSet&lt;&gt;(this.additionalProfiles);
		profiles.addAll(Arrays.asList(environment.getActiveProfiles()));
		environment.setActiveProfiles(StringUtils.toStringArray(profiles));
	}
```</string></div><div class="node-children line"></div></div><div id="ce2accdfac4d" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title ">将现有环境信息 设置为@configurationProperties的数据源，并且放在第一位</div></div><div class="node-remark" contenteditable="true" spellcheck="false" autocapitalize="false">`ConfigurationPropertySources.attach(environment);`</div><div class="node-children line"></div></div><div id="cb79e1798312" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><span class="node-icons" style="width: 25.1px;"><span n="priority" ico="1" class="mind-icons"></span></span><div spellcheck="false" autocapitalize="false" class="node-title " style="border-radius: 6px; font-size: 14px;">发布2.ApplicationEnvironmentPreparedEvent&nbsp;</div></div><div class="node-remark" contenteditable="true" spellcheck="false" autocapitalize="false">ConfigFileApplicationListener会读取所有默认配置文件信息
```
* <ul>
 * <li>file:./config/</li>
 * <li>file:./config/{@literal *}/</li>
 * <li>file:./</li>
 * <li>classpath:config/</li>
 * <li>classpath:</li>
 * </ul>
```</div><div class="node-children line"></div></div><div id="63d1326e8697" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title ">将spring.main的配置绑定到SpringApplication属性上</div></div><div class="node-remark" contenteditable="true" spellcheck="false" autocapitalize="false">`bindToSpringApplication(environment);`</div><div class="node-children line"></div></div><div id="229e75a793d0" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title ">将现有环境信息 设置为@configurationProperties的数据源，更新放在第一位</div></div><div class="node-remark" contenteditable="true" spellcheck="false" autocapitalize="false">`ConfigurationPropertySources.attach(environment);`</div><div class="node-children line"></div></div></div></div><div id="48764555d654" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title " style="border-radius: 0px; color: rgb(102, 102, 102); border-color: rgb(136, 136, 136);">设置忽略bean:spring.beaninfo.ignore</div></div><div class="node-remark" contenteditable="true" spellcheck="false" autocapitalize="false">`
configureIgnoreBeanInfo(environment);
`</div><div class="node-children line"></div></div><div id="29d9d35f4d2b" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title " style="border-radius: 0px; color: rgb(102, 102, 102); border-color: rgb(136, 136, 136);">打印Banner</div></div><div class="node-remark" contenteditable="true" spellcheck="false" autocapitalize="false">```
Banner printedBanner = printBanner(environment);
```</div><div class="node-children line"></div></div><div id="e4bf457e4622" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><span class="node-icons" style="width: 25.1px;"><span n="priority" ico="0" class="mind-icons"></span></span><div spellcheck="false" autocapitalize="false" class="node-title " style="border-radius: 6px;">实例化Spring上下文<br><b>AnnotationConfigServletWebServerApplicationContext</b><br></div></div><div class="node-remark" contenteditable="true" spellcheck="false" autocapitalize="false">```
context = createApplicationContext();
```</div><div class="node-children line"></div></div><div id="4d7053d31e88" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title " style="border-radius: 0px; color: rgb(102, 102, 102); border-color: rgb(136, 136, 136);">初始化失败分析器</div></div><div class="node-remark" contenteditable="true" spellcheck="false" autocapitalize="false">```
exceptionReporters = getSpringFactoriesInstances(SpringBootExceptionReporter.class,
					new Class[] { ConfigurableApplicationContext.class }, context);
			
```</div><div class="node-children line"></div></div><div id="b511b524dc25" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div><div class="node-state"><span class="openIcon ol-icons"></span></div></div><span class="node-type dot"><span></span></span><span class="node-icons" style="width: 25.1px;"><span n="priority" ico="1" class="mind-icons"></span></span><div spellcheck="false" autocapitalize="false" class="node-title " style="border-radius: 6px; font-size: 14px;">准备上下文</div></div><div class="node-remark" contenteditable="true" spellcheck="false" autocapitalize="false">```
prepareContext(context, environment, listeners, applicationArguments, printedBanner);
			
```</div><div class="node-children line"><div id="0de1b5f10512" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title ">将当前环境信息设置到context</div></div><div class="node-remark" contenteditable="true" spellcheck="false" autocapitalize="false">`context.setEnvironment(environment);`</div><div class="node-children line"></div></div><div id="d77fa4e4e442" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title ">调用ApplicationContextInitializer </div></div><div class="node-remark" contenteditable="true" spellcheck="false" autocapitalize="false">`applyInitializers(context);`</div><div class="node-children line"></div></div><div id="3e9636b0cbb0" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><span class="node-icons" style="width: 25.1px;"><span n="priority" ico="2" class="mind-icons"></span></span><div spellcheck="false" autocapitalize="false" class="node-title " style="border-radius: 6px; font-style: normal; font-weight: normal; font-size: 14px; font-family: 微软雅黑;">发布了3.ApplicationContextInitializedEvent</div></div><div class="node-children line"></div></div><div id="b641d10f6068" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title ">打印启动信息和profile.active信息</div></div><div class="node-remark" contenteditable="true" spellcheck="false" autocapitalize="false">```java

if (this.logStartupInfo) {
      logStartupInfo(context.getParent() == null);
      logStartupProfileInfo(context);
   }
```
打印：
```
: Starting ConfigurationFileApplication on DESKTOP-FGTQI9C with PID 18136 (D:\ideaworkspace\java\springboot\springboot_parent\02_configuration_file\target\classes started by zengjin in D:\ideaworkspace\java\springboot\springboot_parent)
: The following profiles are active: dev
```</div><div class="node-children line"></div></div><div id="ed26c5aedc27" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title ">将applicationArguments、printedBanner注册为bean</div></div><div class="node-remark" contenteditable="true" spellcheck="false" autocapitalize="false">```java
ConfigurableListableBeanFactory beanFactory = context.getBeanFactory();
		beanFactory.registerSingleton("springApplicationArguments", applicationArguments);
		if (printedBanner != null) {
			beanFactory.registerSingleton("springBootBanner", printedBanner);
		}
```</div><div class="node-children line"></div></div><div id="cee83110e283" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title ">设置不允许同名bean</div></div><div class="node-remark" contenteditable="true" spellcheck="false" autocapitalize="false">在spring中是允许的
```java
if (beanFactory instanceof DefaultListableBeanFactory) {
			((DefaultListableBeanFactory) beanFactory)
					.setAllowBeanDefinitionOverriding(this.allowBeanDefinitionOverriding);
		}
```</div><div class="node-children line"></div></div><div id="459c7e7905c9" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title ">设置是否懒加载bean</div></div><div class="node-remark" contenteditable="true" spellcheck="false" autocapitalize="false">```java
if (this.lazyInitialization) {
			context.addBeanFactoryPostProcessor(new LazyInitializationBeanFactoryPostProcessor());
		}
```</div><div class="node-children line"></div></div><div id="77eda490183f" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title ">读取启动类为BeanDefinition</div></div><div class="node-remark" contenteditable="true" spellcheck="false" autocapitalize="false">这是容器加载非常关键的一步， 因为要根据启动类加载所有bean , 在这里启动类就相当于配置文件xml ,,
如果你之前看过AnnotationConfigApplicationContext, 它也会读取配置类， 一个意思
</div><div class="node-children line"></div></div><div id="ee58d9658f26" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><span class="node-icons" style="width: 25.1px;"><span n="priority" ico="3" class="mind-icons"></span></span><div spellcheck="false" autocapitalize="false" class="node-title " style="border-radius: 6px; font-size: 14px;">将springboot的监听器添加到context<br>发布4.ApplicationPreparedEvent<br></div></div><div class="node-children line"></div></div></div></div><div id="9cda1bf232d4" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div><div class="node-state"><span class="openIcon ol-icons"></span></div></div><span class="node-type dot"><span></span></span><span class="node-icons" style="width: 25.1px;"><span n="priority" ico="2" class="mind-icons"></span></span><div spellcheck="false" autocapitalize="false" class="node-title " style="border-radius: 6px; font-size: 14px;">刷新容器—加载ioc容器</div></div><div class="node-remark" contenteditable="true" spellcheck="false" autocapitalize="false">```
refreshContext(context);
```</div><div class="node-children line"><div id="2b5f5d078e66" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div><div class="node-state"><span class="openIcon ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title ">AnnotationConfigServletWebServerApplicationContext<br>#refresh<br></div></div><div class="node-children line"><div id="d9b8cded5640" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title ">prepareRefresh()</div></div><div class="node-children line"></div></div><div id="92f672f9f443" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title ">ConfigurableListableBeanFactory beanFactory = obtainFreshBeanFactory()<br></div></div><div class="node-children line"></div></div><div id="306ecf622351" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title ">prepareBeanFactory(beanFactory);<br></div></div><div class="node-children line"></div></div><div id="fc9a8b2fe372" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div><div class="node-state"><span class="openIcon ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title ">postProcessBeanFactory(beanFactory);<br></div></div><div class="node-children line"><div id="e2e100fa8434" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div><div class="node-state"><span class="openIcon ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title ">注册BeanPostProceessor:<br>WebApplicationContextServletContextAwareProcessor<br></div></div><div class="node-children line"><div id="6139248b50a6" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title ">ServletContextAware</div></div><div class="node-children line"></div></div><div id="266742ef42dc" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title ">ServletConfigAware</div></div><div class="node-children line"></div></div></div></div><div id="09c92b11a5fc" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title " style="border-radius: 0px; color: rgb(102, 102, 102); border-color: rgb(136, 136, 136);">忽略自动装配的接口方法</div></div><div class="node-remark" contenteditable="true" spellcheck="false" autocapitalize="false">`
beanFactory.ignoreDependencyInterface(ServletContextAware.class);
`</div><div class="node-children line"></div></div><div id="5123834e4928" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title ">注册WebApplicationContext作用域</div></div><div class="node-children line"></div></div></div></div><div id="e6bfcacf296d" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div><div class="node-state"><span class="openIcon ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title ">invokeBeanFactoryPostProcessors(beanFactory);</div></div><div class="node-children line"><div id="be41e2bed6a5" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div><div class="node-state"><span class="openIcon ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title ">解析启动类(配置类)</div></div><div class="node-children line"><div id="8cb72f4499d8" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title ">ConfigurationClassPostProcessor<br>#postProcessBeanDefinitionRegistry</div></div><div class="node-children line"></div></div></div></div><div id="57a14926fe91" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div><div class="node-state"><span class="openIcon ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title ">注册自动配置类</div></div><div class="node-children line"><div id="a610e239d55c" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title ">processDeferredImportSelectors()</div></div><div class="node-children line"></div></div></div></div><div id="b893d3c0b009" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title ">（内嵌tomcat）注册@WebServlet、@WebFilter、@WebListener</div></div><div class="node-children line"></div></div></div></div><div id="e265691b4368" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title ">registerBeanPostProcessors(beanFactory);<br></div></div><div class="node-children line"></div></div><div id="582a657a3415" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title ">initMessageSource();<br></div></div><div class="node-children line"></div></div><div id="37cbe65e437e" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title ">initApplicationEventMulticaster();<br></div></div><div class="node-children line"></div></div><div id="fa63056cf974" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div><div class="node-state"><span class="openIcon ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title " style="border-radius: 6px;">onRefresh();</div></div><div class="node-children line"><div id="57316c981709" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div><div class="node-state"><span class="openIcon ol-icons"></span></div></div><span class="node-type dot"><span></span></span><span class="node-icons" style="width: 25.1px;"><span n="priority" ico="3" class="mind-icons"></span></span><div spellcheck="false" autocapitalize="false" class="node-title " style="border-radius: 6px; font-size: 14px;">（内嵌tomcat）创建servlet容器<br>注册DispatcherServlet/Servlet</div></div><div class="node-children line"><div id="dfe1921d3a06" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title ">createWebServer</div></div><div class="node-children line"></div></div></div></div></div></div><div id="d4efc85742dd" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title ">registerListeners();</div></div><div class="node-children line"></div></div><div id="5e033c67b41d" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title ">finishBeanFactoryInitialization(beanFactory);</div></div><div class="node-children line"></div></div><div id="3d8298e9232c" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title ">finishRefresh();<br></div></div><div class="node-children line"></div></div><div id="f3d76e1ffcd4" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title ">resetCommonCaches();</div></div><div class="node-children line"></div></div></div></div></div></div><div id="48ed9797e2f5" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title " style="border-radius: 0px; color: rgb(102, 102, 102); border-color: rgb(136, 136, 136);">afterRefresh—待扩展</div></div><div class="node-remark" contenteditable="true" spellcheck="false" autocapitalize="false">```
afterRefresh(context, applicationArguments);
```</div><div class="node-children line"></div></div><div id="7f06cdde9d89" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title " style="border-radius: 5px; font-style: normal; font-weight: normal; color: rgb(255, 255, 255); font-size: 14px; font-family: 微软雅黑;">记录启动结束时间<br>输出启动耗时时间</div></div><div class="node-remark" contenteditable="true" spellcheck="false" autocapitalize="false">```
stopWatch.stop();
if (this.logStartupInfo) {
				new StartupInfoLogger(this.mainApplicationClass).logStarted(getApplicationLog(), stopWatch);
			}
```</div><div class="node-children line"></div></div><div id="fa55d78f9d41" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div><div class="node-state"><span class="openIcon ol-icons"></span></div></div><span class="node-type dot"><span></span></span><span class="node-icons" style="width: 25.1px;"><span n="priority" ico="4" class="mind-icons"></span></span><div spellcheck="false" autocapitalize="false" class="node-title " style="border-radius: 6px; font-size: 14px;">发布ApplicationStartedEvent<br></div></div><div class="node-remark" contenteditable="true" spellcheck="false" autocapitalize="false">```
listeners.started(context);
```</div><div class="node-children line"><div id="523cd2d25fee" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><span class="node-icons" style="width: 25.1px;"><span n="priority" ico="5" class="mind-icons"></span></span><div spellcheck="false" autocapitalize="false" class="node-title " style="border-radius: 6px; font-size: 14px;">发布AvailabilityChangeEvent<br>LivenessState.CORRECT<br></div></div><div class="node-remark" contenteditable="true" spellcheck="false" autocapitalize="false">指示该应用程序被视为处于活动状态。</div><div class="node-children line"></div></div></div></div><div id="145ceb815f11" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div><div class="node-state"><span class="openIcon ol-icons"></span></div></div><span class="node-type dot"><span></span></span><span class="node-icons" style="width: 25.1px;"><span n="priority" ico="6" class="mind-icons"></span></span><div spellcheck="false" autocapitalize="false" class="node-title " style="border-radius: 6px; font-size: 14px;">发布ApplicationReadyEvent<br></div></div><div class="node-remark" contenteditable="true" spellcheck="false" autocapitalize="false">```java
try {
			listeners.running(context);
		}
```</div><div class="node-children line"><div id="0cfde7899ffe" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><span class="node-icons" style="width: 25.1px;"><span n="priority" ico="7" class="mind-icons"></span></span><div spellcheck="false" autocapitalize="false" class="node-title " style="border-radius: 6px; font-size: 14px;">发布AvailabilityChangeEvent<br>ReadinessState.ACCEPTING_TRAFFIC</div></div><div class="node-remark" contenteditable="true" spellcheck="false" autocapitalize="false">指示应用程序已准备就绪，可以处理请求。</div><div class="node-children line"></div></div></div></div><div id="9eb2844afd2a" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div><div class="node-state"><span class="openIcon ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title ">callRunners</div></div><div class="node-children line"><div id="813132a559e0" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title ">ApplicationRunner.run</div></div><div class="node-children line"></div></div><div id="dc6dec347df1" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title ">CommandLineRunner.run</div></div><div class="node-children line"></div></div></div></div><div id="af58a308453d" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><span class="node-icons" style="width: 25.1px;"><span n="priority" ico="8" class="mind-icons"></span></span><div spellcheck="false" autocapitalize="false" class="node-title " style="border-radius: 6px; font-size: 14px;">如果启动时发生异常，则发送ApplicationFailedEvent。</div></div><div class="node-remark" contenteditable="true" spellcheck="false" autocapitalize="false">```
catch (Throwable ex) {
			handleRunFailure(context, ex, exceptionReporters, listeners);
			throw new IllegalStateException(ex);
		}
```</div><div class="node-children line"></div></div></div></div><div id="b35fa3e4bdad" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title ">作者：徐庶</div></div><div class="node-children line"></div></div><div id="eeb2a25813d8" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div><div class="node-state"><span class="openIcon ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title ">1.加载META/MANIFEST.MF<br>2.运行JarLauncher<br>3.加载BOOT-INF/classes和BOOT-INF/lib<br>4.找到Start-Class</div></div><div class="node-children line"><div id="e73a849c3f25" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div><div class="node-state"><span class="openIcon ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title ">java -jar</div></div><div class="node-children line"><div id="d609639e0102" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title " style="border-radius: 5px; font-weight: bold;">1.通过内嵌servlet容器启动（jar）</div></div><div class="node-children line"></div></div></div></div></div></div><div id="f9ad56563544" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div><div class="node-state"><span class="openIcon ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title ">javax.servlet.ServletContainerInitializer</div></div><div class="node-children line"><div id="b15b9797b95f" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div><div class="node-state"><span class="openIcon ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title ">SPI</div></div><div class="node-children line"><div id="8a2db4f72b4a" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div><div class="node-state"><span class="openIcon ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title ">Tomcat.start()</div></div><div class="node-remark" contenteditable="true" spellcheck="false" autocapitalize="false">
 [tomcat如何读取SPI](https://blog.csdn.net/gaohaicheng123/article/details/105827295)

**tomcat大致调用顺序：**
```
tomcat启动时webConfig() 的调用链：
Tomcat.start()-&gt;各种代理的start()-&gt;org.apache.catalina.core.StandardContext.startInternal-&gt;LifecycleBase.fireLifecycleEvent-&gt;org.apache.catalina.startup.ContextConfig.lifecycleEvent-&gt;configureStart-&gt;webConfig-&gt;processServletContainerInitializers()-&gt;load(Class<t> serviceType);
```</t></div><div class="node-children line"><div id="0e668d5b667f" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div><div class="node-state"><span class="openIcon ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title " style="border-radius: 5px;">2.通过外部servlet容器启动（war）</div></div><div class="node-children line"><div id="22e4b3c1c1ef" class="node-element wider"><div class="node-self"><div class="node-contr-action"><div class="opmenu-open-icon"><span class="ol-icons"></span></div></div><span class="node-type dot"><span></span></span><div spellcheck="false" autocapitalize="false" class="node-title hide"></div></div><div style="width:98px;" class="node-image"><img src="./6059e2f7e0b34d780efc7724"></div><div class="node-children line"></div></div></div></div></div></div></div></div></div></div></div>
<div id="outline-con-search"></div>
</div>
</div>
<div class="util-container">
<input type="text" id="outline_input" style="position:fixed;top:44px;opacity:0;z-index:-1;" value="">
<div id="outline-hl-menu" class="outline-hl-menu outline-dropdown">
<a id="btn_shortkey" op="shortkey" class="outline-item"><span class="ol-icons"></span>快捷键说明</a>
<a id="btn_feedback" op="feedback" class="outline-item"><span class="ol-icons"></span>意见反馈</a>
</div>
<div id="colla-users-con" class="colla-users-con" style="display: block;">
<div class="colla-users-list">
</div>
</div>
</div>
<div id="dlg_import" class="dlg-import  outline-dlg noselect">
<h3>文件导入</h3>
<form id="share_upload_form" action="https://www.processon.com/import/flow" method="post" enctype="multipart/form-data" style="position:relative;">
<div>
<div class="upload-contents">
<div class="drop-img"><span style="font-size:60px;color: #999;" class="ol-icons"></span></div>
<div class="drop-text"><span>直接拖入文件，即可上传</span></div>
<div class="btn-wrap">
<div id="import_btn" class="button default btn-lg">添加文件</div>
</div>
</div>
</div>
<input id="sys_input" type="hidden" name="sys" value="Windows">
<input id="type_input" type="hidden" name="type" value="vsd">
<input id="name_input" type="hidden" name="fileName">
<input id="team_input" type="hidden" name="teamId">
<input id="folder_input" type="hidden" name="folder">
</form>
<div class="des-list" style="resize: none;outline: none;font-size: inherit;"></div>
</div>
<div id="dlg_export" class="dlg-export outline-dlg padding-lr-none noselect">
<h3>文件导出</h3>
<div class="outline-dlg-content dlg-menu">
<ul class="export-menu">
<li class="export-i" type="opml"><span class="ol-icons"></span>OPML文件<span class="res">(*.opml 大纲文件)</span><span class="r-des"></span></li>
<li class="export-i" type="png"><span class="ol-icons"></span>图片文件<span class="res">（*.png）</span><span class="r-des"></span></li>
<li class="export-i" type="jpg"><span class="ol-icons"></span>JPG文件<span class="res">（*.jpg 默认白底）</span><span class="r-des"></span></li>
<li class="export-i" type="pdf"><span class="ol-icons"></span>PDF文件<span class="res">（*.pdf）</span><span class="r-des"></span></li>
<li class="export-i" type="pos"><span class="icon-img pos"></span>POS文件<span class="res">（*.pos 可导入，包含图片和图形结构定义）</span><span class="r-des"></span></li>
<li class="seb"></li>
<li class="export-i" type="word"><span class="ol-icons"></span>Word文件<span class="res"> (*.docx)</span><span class="r-des"></span></li>
<li class="export-i" type="ppt"><span class="ol-icons"></span>PPT文件<span class="res">(*.pptx)</span><span class="r-des"></span></li>
<li class="export-i" type="csv"><span class="ol-icons"></span>Excel文件<span class="res">(*.csv)</span> &nbsp;<span class="r-des"></span></li>
<li class="export-i" type="xmind"><span class="icon-img xmind"></span>XMind文件<span class="res"> (*.xmind)</span><span class="r-des"></span></li>
<li class="export-i" type="fmind"><span class="icon-img freemind"></span>FreeMind文件<span class="res">(*.mm)</span><span class="r-des"></span></li>
</ul>
</div>
</div>
<ul class="op-context-menu">
<li op="complete"><label>完成</label><span class="op-explain">Shift+Enter</span></li>
<li op="remark"><label>备注</label><span class="op-explain">Ctrl+Enter</span></li>
<li op="image"><label>图片</label></li>
<li op="flow"><label>流程图</label></li>
<li op="mind"><label>思维导图</label></li>
<li op="icons"><label>图标</label><span class="op-explain ol-icons"><i class="ol-icons"></i></span>
<ul id="mind-dock-right-icons" class="child-menu icons-menu">
<li>
<span ico="0" n="priority" style="color:#f00;" class="mind-icons"></span>
<span ico="1" n="priority" style="color:#f60;" class="mind-icons"></span>
<span ico="2" n="priority" style="color:#ffaf38" class="mind-icons"></span>
<span ico="3" n="priority" class="mind-icons"></span>
<span ico="4" n="priority" class="mind-icons"></span>
<span ico="5" n="priority" class="mind-icons"></span>
<span ico="6" n="priority" class="mind-icons"></span>
<span ico="7" n="priority" class="mind-icons"></span>
<span ico="8" n="priority" class="mind-icons"></span>
</li>
<li>
<span ico="9" n="face" class="mind-icons"></span>
<span ico="11" n="face" class="mind-icons"></span>
<span ico="10" n="face" class="mind-icons"></span>
<span ico="33" n="arrow" class="mind-icons"></span>
<span ico="34" n="arrow" class="mind-icons"></span>
<span ico="35" n="arrow" class="mind-icons"></span>
<span ico="36" n="arrow" class="mind-icons"></span>
<span ico="37" n="arrow" class="mind-icons"></span>
</li>
<li>
<span ico="26" n="flag" style="color:#444;" class="mind-icons"></span>
<span ico="27" n="flag" style="color:#60a0f0;" class="mind-icons"></span>
<span ico="28" n="flag" style="color:#bf1e1b;" class="mind-icons"></span>
<span ico="29" n="flag" style="color:#ff9f1a;" class="mind-icons"></span>
<span ico="30" n="flag" style="color:#30bfbf;" class="mind-icons"></span>
<span ico="31" n="flag" style="color:rgb(80, 194, 139);" class="mind-icons"></span>
<span ico="32" n="flag" style="color:#ff0000;" class="mind-icons"></span>
</li>
<li>
<span ico="17" n="completion" class="mind-icons"></span>
<span ico="18" n="completion" class="mind-icons"></span>
<span ico="19" n="completion" class="mind-icons"></span>
<span ico="20" n="completion" class="mind-icons"></span>
<span ico="21" n="completion" class="mind-icons"></span>
<span ico="22" n="completion" class="mind-icons"></span>
<span ico="23" n="completion" class="mind-icons"></span>
<span ico="24" style="font-size: 17px;" n="completion" class="mind-icons"></span>
</li>
<li>
<span ico="38" class="mind-icons"></span>
<span ico="39" class="mind-icons"></span>
<span ico="40" class="mind-icons"></span>
<span ico="41" class="mind-icons"></span>
<span ico="42" class="mind-icons"></span>
<span ico="43" class="mind-icons"></span>
<span ico="44" class="mind-icons"></span>
<span ico="45" class="mind-icons"></span>
<span ico="46" class="mind-icons"></span>
<span ico="47" class="mind-icons"></span>
<span ico="48" class="mind-icons"></span>
<span ico="49" class="mind-icons"></span>
<span ico="50" class="mind-icons"></span>
<span ico="51" class="mind-icons"></span>
<span ico="52" class="mind-icons"></span>
<span ico="53" class="mind-icons"></span>
<span ico="54" class="mind-icons"></span>
<span ico="55" class="mind-icons"></span>
<span ico="56" class="mind-icons"></span>
<span ico="57" class="mind-icons"></span>
<span ico="58" class="mind-icons"></span>
<span ico="59" class="mind-icons"></span>
<span ico="60" class="mind-icons"></span>
<span ico="61" class="mind-icons"></span>
<span ico="62" class="mind-icons"></span>
<span ico="63" class="mind-icons"></span>
<span ico="64" class="mind-icons"></span>
</li>
</ul>
</li>
<li>
<span class="style_sep"></span>
<div class="outline-style-menu">
<i op="b" class="ol-icons active"></i>
<i op="i" class="ol-icons"></i>
<i op="u" class="ol-icons"></i>
<i op="s" class="ol-icons"></i>
<div style="height: 12px; width: 100%;"></div>
<span op="color" val="#000"><span style="background-color: #000;" class="color-dot active"></span></span>
<span val="#aaa" op="color"><span style="background-color: #aaa;" class="color-dot gray"></span></span>
<span val="#ff4050" op="color"><span style="background-color: #ff4050;" class="color-dot red"></span></span>
<span op="color" val="#2ad352"><span style="background-color: #2ad352;" class="color-dot green"></span></span>
<span val="#29b6f2" op="color"><span style="background-color: #29b6f2;" class="color-dot blue"></span></span>
</div>
<span class="style_sep"></span>
</li>
<li op="del"><label>删除</label><span class="op-explain">Ctrl+Shift+Space</span></li>
</ul>
<div class="mind-corner right">
<span class="mind-icons close"></span>
<div tit="shortcut" class="mind-corner-content">
<div class="corner-title">
<div class="label">快捷键</div>
</div>
<div id="shortcut-container" class="scroll">
<div><label><span keys="">Enter</span></label><span>增加同级节点</span></div>
<div><label><span keys="">Tab</span></label><span>向右缩进</span></div>
<div><label><span keys="">Shift+Tab</span></label><span>向左缩进</span></div>
<div><label><span keys="">Ctrl+Enter</span></label><span>设置完成</span></div>
<div><label><span keys="">Shift+Enter</span></label><span>添加备注</span></div>
<div><label><span keys="">Ctrl+/</span></label><span>展开/收起节点</span></div>
<div><label><span keys="">Ctrl+拖拽</span></label><span>多选</span></div>
<div><label><span keys="">Shift+↑</span></label><span>向上多选节点</span></div>
<div><label><span keys="">Shift+↓</span></label><span>向下多选节点</span></div>
<div><label><span keys="">Ctrl+Shift+Backspace</span></label><span>快速删除节点</span></div>
<div><label><span keys="">Delete</span></label><span>删除选中节点</span></div>
<div><label><span keys="">Ctrl+Shift+↑</span></label><span>向上移动节点</span></div>
<div><label><span keys="">Ctrl+Shift+↓</span></label><span>向下移动节点</span></div>
<div><label><span keys="">↑</span></label><span>向上移动光标</span></div>
<div><label><span keys="">↓</span></label><span>向下移动光标</span></div>
<div><label><span keys="">Ctrl+,</span>或者<span keys="">Ctrl+.</span></label><span>快速聚焦</span></div>
<div><label><span keys="">Ctrl+C</span></label><span>复制</span></div>
<div><label><span keys="">Ctrl+X</span></label><span>剪切</span></div>
<div><label><span keys="">Ctrl+V</span></label><span>粘贴</span></div>
<div><label><span keys="">Ctrl+Z</span></label><span>撤销</span></div>
<div><label><span keys="">Ctrl+Y</span></label><span>恢复</span></div>
</div>
</div>
</div>
<div class="op-con-list">
<div tit="import_opml"><span></span><span>导入文件（opml、pos格式）</span></div>
<div class="sep"></div>
<div tit="download_png"><span></span><span>另存为图片格式（.png）</span></div>
<div tit="download_opml"><span></span><span>另存为opml格式（可用于导入）</span></div>
</div>
<div id="chartEditor" class="chart-app outline-dlg outline-animate-dlg"></div>
<script type="text/javascript">
deviceType = deviceIdentify();
function deviceIdentify(){
var device = getUrlParams('device');
if(!device){
if(/(iPhone|iPad|iPod|iOS)/i.test(navigator.userAgent)) { //判断iPhone|iPad|iPod|iOS
device = 'ios'
}else if(/(Android)/i.test(navigator.userAgent)) {  //判断Android
device = 'android'
}else{
device = 'yun'
}
}
return device
}
function getUrlParams(name){
var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
var r = window.location.search.substr(1).match(reg);
if (r != null){
return unescape(r[2]);
}
return null;
};
</script>
<script type="text/javascript">
window.zhuge = window.zhuge || [];window.zhuge.methods = "_init debug identify track trackLink trackForm page".split(" ");
window.zhuge.factory = function(b) {return function() {var a = Array.prototype.slice.call(arguments);a.unshift(b);
window.zhuge.push(a);return window.zhuge;}};for (var i = 0; i < window.zhuge.methods.length; i++) {
var key = window.zhuge.methods[i];window.zhuge[key] = window.zhuge.factory(key);}window.zhuge.load = function(b, x) {
if (!document.getElementById("zhuge-js")) {var a = document.createElement("script");var verDate = new Date();
var verStr = verDate.getFullYear().toString()+ verDate.getMonth().toString() + verDate.getDate().toString();
a.type = "text/javascript";a.id = "zhuge-js";a.async = !0;a.src = (location.protocol == 'http:' ? "http://sdk.zhugeio.com/zhuge.min.js?v=" : 'https://zgsdk.zhugeio.com/zhuge.min.js?v=') + verStr;
a.onerror = function(){window.zhuge.identify = window.zhuge.track = function(ename, props, callback){if(callback && Object.prototype.toString.call(callback) === '[object Function]')callback();};};
var c = document.getElementsByTagName("script")[0];c.parentNode.insertBefore(a, c);window.zhuge._init(b, x)}};
window.zhuge.load('3f37ba50e54f4374b9af5be6d12b208f',{debug:false});//éç½®åºç¨çAppKey
</script>
<script type="text/javascript">
(function(){var po_user_id = getCookie();if(po_user_id == ''){removeLoginTag();return};var userLoginTag = localStorage.getItem('userLoginTag_'+ po_user_id);if(userLoginTag){return}zhuge.identify(po_user_id, {});localStorage.setItem('userLoginTag_'+ po_user_id, 'login');function getCookie(){var name = "processon_userKey=";
var ca = document.cookie.split(';');for(var i=0, len = ca.length; i < len; i++){var c = ca[i].trim();if (c.indexOf(name) == 0){return c.substring(name.length,c.length);};}return "";}
function removeLoginTag(){for(var key in localStorage){if(key.indexOf('userLoginTag') > -1){localStorage.removeItem(key)}}}})();
window.poCollect = function(name, paramObj){if(!name || typeof paramObj != 'object'){return}
try{zhuge.track(name, paramObj);}catch(e){}
}
</script>
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-28802488-1', 'auto');
ga('send', 'pageview');
</script>
<script type="text/javascript" src="./blank-f8954195.js.下载"></script>
<script type="text/javascript" charset="UTF-8" src="./jquery.js.下载"></script>
<script type="text/javascript" charset="UTF-8" src="./outline.js.下载"></script>
<script type="text/javascript" charset="UTF-8" src="./outline.util.js.下载"></script>
<script>
var outlineObj = null;
$.get("/diagraming/getdef", {id:chartId,tempId:tempId})
.then(function(data){
data = JSON.parse(data.def);
var opts = {
target:"outline-con",
line:{
show:true
},
readOnly:true,
indent:"wider" //wider || normal
};
outlineObj = new Outline(opts, data);
});
//记录进入页面的来源
var ur_resource = sessionStorage.getItem('ur_resource_outline') || 'po_mind';
poCollect('页面访问',{
"页面名称": "大纲编辑器_预览",
"页面来源": ur_resource
});
</script>


</body></html>